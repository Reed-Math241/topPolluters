---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

<!-- You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this.  -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Top Climate, Air, and Water Polluters (2018)

<!-- badges: start -->
<!-- badges: end -->

Researchers at the Political Economy Research Institute (PERI) at the University of Massachusetts Amherst created this all encompassing dataset on the top 100 parent entities or corporations that contributed to greenhouse gas pollution, air pollution, and water pollution. 

## Installation

The development version of XXX is available from [GitHub](https://github.com/) with:
```{r}
install.packages("devtools")
install.packages("topPolluters")
```
## Example



```{r example}
library(topPolluters)
library(tidyr)
library(ggplot2)
library(forcats)

topAir <-  topPolluters %>%
  filter(toxic.air.rank <= 30) %>%
  select(polluter, toxic.air.rank, toxic.air.poor, toxic.air.minority) %>%
  pivot_longer(cols = c(toxic.air.minority, toxic.air.poor),
               names_to = "metric",
               values_to = "percentage")
topAir$percentage <- topAir$percentage * 100
  
ggplot(topAir, aes(x = polluter, y = percentage, fill = metric)) +
  geom_bar(width = 0.7, position = "dodge", stat = "identity") +
  theme_bw() +
  aes(x = fct_reorder(polluter, toxic.air.rank, .desc = TRUE)) +
  scale_y_continuous(breaks = c(0, 20, 40, 60, 80, 100),
                     labels = c("0%", "20%", "40%", "60%", "80%", "100%"),
                     expand = c(0, 1)) +
  labs(title = "The Top 30 U.S. Industrial Pollutors of Air Toxics\n
       And the Resulting Exposure to Low-Income People and Minorities",
       caption = "The ranking of the top air pollutors is based on total potential chronic human health risk from their facilities.
       The percentages are in regards to the makeup of the at-risk populations (which are typically those nearest to the toxic facilities),
       but spefically how much of the at risk population is below the poverty line or is a racial/ethnic minority.",
       x = "Top Pollutors of Air Toxics (in Descending Order of Rank)") +
  theme(axis.title.x = element_blank(),
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5),
        plot.caption = element_text(hjust = 0.5, size = 10)) +
  scale_fill_manual(values=c("#E69F00", "#56B4E9"),
                       breaks=c("toxic.air.poor", "toxic.air.minority"),
                       labels=c("People below\nthe poverty line", "Racial/ethnic\nminorities")) +
  coord_flip() 
  
```

#devtools::build_readme()

